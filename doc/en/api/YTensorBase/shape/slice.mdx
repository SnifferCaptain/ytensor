# Shape Operations: Slicing

This document describes the slicing methods `slice()` and `slice_()` for the `YTensorBase` class.

## Overview

Slicing operations are used to obtain a subset of a tensor along a specified dimension:

| Method | Return Type | In-place | Description |
| --- | --- | --- | --- |
| `slice()` | `YTensorBase` | ❌ | Returns a new view of the sliced data. |
| `slice_()` | `YTensorBase&` | ✅ | Modifies the current object in-place. |

---

## `slice()`

### Core Function Description

Slices the tensor along a specified dimension and returns a new tensor view.

### Function Signature

```cpp
YTensorBase slice(
    int atDim,
    int start = 0,
    int end = 0,
    int step = 1,
    bool autoFix = true
) const;
```

### Parameters

| Name | Type | Default Value | Description |
| --- | --- | --- | --- |
| `atDim` | `int` | - | **Required**. The index of the dimension to slice (starting from 0). Supports negative indexing. |
| `start` | `int` | `0` | Starting position of the slice (**inclusive**). Supports negative and circular indexing. |
| `end` | `int` | `0` | Ending position of the slice (**exclusive**). If set to `0`, it represents the last element of the dimension (inclusive). Supports negative indexing. |
| `step` | `int` | `1` | Transition distance between elements. Can be positive or negative, but **cannot be 0**. |
| `autoFix` | `bool` | `true` | Whether to automatically fix the slice range. If enabled, it swaps `start` and `end` if `start > end`. |

### Return Value

* **Type**: `YTensorBase`
* **Description**: Returns the resulting sliced tensor.
* **Memory Behavior**: The returned object is a **view** of the original data, sharing the underlying memory pointer. Modifying the data in the returned tensor will affect the original tensor.

### Slicing Rules

1. **Circular Indexing**: All indices support negative values and circular wrapping; modulo operations are used to map indices to valid ranges.
2. **Range Calculation**: `end` points to "the position after the last element" (it is exclusive).
3. **autoFix**: Automatically swaps `start` and `end` if the calculated end position is less than the start position.
4. **Step**: `step > 0` for forward slicing, `step < 0` for backward slicing; `step = 0` throws an exception.

### Usage Example

```cpp
#include "ytensor_single.hpp"

void example() {
    YTensorBase tensor = YTensorBase::zeros({3, 4, 5}, "float32");
    
    // Slice dimension 1 (size 4) from index 1 to 3: [1, 3)
    YTensorBase sliced = tensor.slice(1, 1, 3);
    // sliced.shape() -> {3, 2, 5}
    
    // Slicing with a step: every second element
    YTensorBase vec = YTensorBase::zeros({10}, "float32");
    YTensorBase even = vec.slice(0, 0, 0, 2);
    // even.size() -> 5
}
```

---

## `slice_()`

### Core Function Description

Performs an in-place slicing operation on a specified dimension, modifying the current tensor object.

### Function Signature

```cpp
YTensorBase& slice_(
    int atDim,
    int start = 0,
    int end = 0,
    int step = 1,
    bool autoFix = true
);
```

### Return Value

* **Type**: `YTensorBase&`
* **Description**: Returns a reference to the current object, supporting method chaining.

### Usage Example

```cpp
YTensorBase tensor = YTensorBase::zeros({5, 10}, "float32");

// Slicing in-place
tensor.slice_(0, 1, 4);
// tensor.shape() -> {3, 10}

// Method chaining
tensor.slice_(0, 0, 2).slice_(1, 0, 5);
```

---

## Notes

:::info
**Views Share Memory**

The tensor returned by `slice()` shares the same underlying memory as the original. Modifying the slice affects the original tensor. If you need an independent copy, use the `clone()` method.
:::

:::warning
**Differences from Python/NumPy**

In `YTensorBase`, regardless of whether `step` is positive or negative, `start` must be less than or equal to `end - 1` (unless `autoFix` is enabled). This differs from Python's logic where `start > end` is used when `step < 0`.
:::

:::danger
**Stride Cannot Be Zero**

Setting `step = 0` will throw a `std::invalid_argument` exception.
:::

---

## Related Content

- [Shape Queries](./query.mdx) - Methods like `shape()`, `size()`, etc.
- [Shape Operations: Reshaping](./reshape.mdx) - Methods like `view()` and `reshape()`.
- [Memory Management](../construction/memory.mdx) - The `clone()` method.
